include: experiments/rsna-intracranial/include/dataset.yaml

entrypoint: classification2d

model_params:
  arch: 'ResNetClassifier2d'
  name: 'ResNetClassifier2d'
  num_classes: 6
  hidden_dims: [128, 256, 512, 256, 128, 64, 32, 16]
  pooling: max

exp_params:
  loss_params:
    objective: mse
    #baseline: 0.5

  batch_size: 4
  optimizer:
    lr: 0.00001
    weight_decay: 0.00001
  plot:
    fn: classifier2d
    sample_every_n_steps: 1000
    examples_per_class: 6
    params:
      class_names:
        - Epidural
        - Intraparenchymal
        - Intraventricular
        - Subarachnoid
        - Subdural
        - Any

trainer_params:
  max_epochs: 8
  log_every_n_steps: 20
  check_val_every_n_epoch: 1

manual_seed: 1498
